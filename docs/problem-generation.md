# Problem Generation Guide

This guide explains how to generate new test problems for the MinCostFlow benchmarks.

## Overview

The benchmark program now supports dynamic problem generation via command-line. Generated problems are automatically included as embedded resources in the next build.

## Generating Problems

### Basic Usage

```bash
cd src/MinCostFlow.Benchmarks
dotnet run -- --generate <type> <parameters>
```

### Problem Types

#### Assignment Problems
Generate bipartite assignment problems:
```bash
dotnet run -- --generate assignment <size>

# Examples:
dotnet run -- --generate assignment 10      # 10x10 assignment
dotnet run -- --generate assignment 100     # 100x100 assignment
dotnet run -- --generate assignment 1000    # 1000x1000 assignment
```

#### Transportation Problems
Generate transportation problems with sources and sinks:
```bash
dotnet run -- --generate transport <sources> <sinks>

# Examples:
dotnet run -- --generate transport 10 15    # 10 sources, 15 sinks
dotnet run -- --generate transport 50 50    # 50 sources, 50 sinks
dotnet run -- --generate transport 100 200  # 100 sources, 200 sinks
```

#### Circulation Problems
Generate circulation problems with specified density:
```bash
dotnet run -- --generate circulation <nodes> <density>

# Examples:
dotnet run -- --generate circulation 100 0.1    # 100 nodes, 10% density
dotnet run -- --generate circulation 1000 0.05  # 1000 nodes, 5% density
dotnet run -- --generate circulation 5000 0.02  # 5000 nodes, 2% density
```

#### Path Problems
Generate simple path problems:
```bash
dotnet run -- --generate path <nodes>

# Examples:
dotnet run -- --generate path 100    # 100-node path
dotnet run -- --generate path 1000   # 1000-node path
dotnet run -- --generate path 10000  # 10000-node path
```

#### Grid Problems
Generate grid network problems:
```bash
dotnet run -- --generate grid <rows> <cols>

# Examples:
dotnet run -- --generate grid 10 10     # 10x10 grid
dotnet run -- --generate grid 50 50     # 50x50 grid
dotnet run -- --generate grid 100 200   # 100x200 grid
```

## File Organization

Generated problems are automatically placed in the appropriate category folder:
- **Small** (≤ 100 nodes): `MinCostFlow.Problems/Resources/small/`
- **Medium** (≤ 5000 nodes): `MinCostFlow.Problems/Resources/medium/`
- **Large** (> 5000 nodes): `MinCostFlow.Problems/Resources/large/`

Each problem generates two files:
- `.min` - The problem definition in DIMACS format
- `.sol` - The optimal solution (computed during generation)

## Automatic Inclusion

Generated problems are automatically included in benchmarks:
1. Files in `Resources/` folders are embedded as resources via the .csproj file
2. The `DynamicProblems` class discovers all embedded problems at runtime
3. Benchmarks automatically include all discovered problems

## Verifying Generation

After generating problems:
1. Check that files were created in the correct Resources folder
2. Rebuild the solution to embed the new resources
3. Run benchmarks to see the new problems included

```bash
# Generate a problem
dotnet run -- --generate assignment 75

# Rebuild to embed resources
dotnet build

# Run benchmarks to see it included
dotnet run -- --stats
```

## Cost Ranges

The generator automatically adjusts cost ranges based on problem size:
- Small problems: costs in range [1, 10]
- Medium problems: costs in range [1, 100]  
- Large problems: costs in range [1, 1000]

## Tips

1. **Balanced Problems**: For assignment and transportation problems, use balanced dimensions for best results
2. **Density**: For circulation problems, use lower density (0.01-0.1) for larger graphs
3. **Naming**: Generated files follow consistent naming patterns (e.g., `assignment_50x50.min`)
4. **Solutions**: Solutions are generated by solving with NetworkSimplex, ensuring correctness

## Example Workflow

```bash
# Generate a set of assignment problems
dotnet run -- --generate assignment 25
dotnet run -- --generate assignment 75  
dotnet run -- --generate assignment 200

# Generate some transportation problems
dotnet run -- --generate transport 20 30
dotnet run -- --generate transport 80 80

# Rebuild and run benchmarks
cd ../..
dotnet build
cd src/MinCostFlow.Benchmarks
dotnet run -- --benchmark
```

The new problems will automatically appear in the benchmark results!